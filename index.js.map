{"version":3,"file":"index.js","sources":["../src/constants.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const TOAST_POSITIONS = {\n  TOP_LEFT: 'topLeft', TOP_RIGHT: 'topRight',\n\n};\n\nexport const TOAST_MESSAGE = {\n  NO_IMAGES_MATCHING_SEARCH_QUERY: 'Sorry, there are no images matching your search query. Please try again!',\n  REACHED_END_OF_SEARCH_RESULTS: 'We\\'re sorry, but you\\'ve reached the end of search results.',\n  VALID_SEARCH_QUERY: 'Please enter a valid search!',\n  QUERY_FAILED: 'Query failed!',\n\n};\n\nexport const TOAST_METHODS = {\n  WARNING: 'warning', ERROR: 'error', INFO: 'info',\n\n};\n\nexport const EVENT_LISTENER_TYPE = {\n  SUBMIT: 'submit', CLICK: 'click',\n\n};\n\nexport const PAGE_ELEMENTS = {\n  FORM: 'form', LOADER: '.loader', GALLERY: '.gallery', BTN_MORE: '.btnMore', GALLERY_ITEM: '.gallery-item',\n};\n\nexport const QUERY_PARAMS = {\n  API_KEY: '46865646-27ce533d0a2b530f03419db89', URL: 'https://pixabay.com/api/',\n};\n\nexport const SCROLL_BEHAVIOR = 'smooth';\n\nexport const RESPONSE = {\n  HITS: 'hits', TOTAL_HITS: 'totalHits', TOTAL: 'total',\n};\n\nexport const HITS_ITEM = {\n  COLLECTIONS: 'collections',\n  COMMENTS: 'comments',\n  DOWNLOADS: 'downloads',\n  ID: 'id',\n  IMAGE_HEIGHT: 'imageHeight',\n  IMAGE_WIDTH: 'imageWidth',\n  LARGE_IMAGE_URL: 'largeImageURL',\n  LIKES: 'likes',\n  PAGE_URL: 'pageURL',\n  PREVIEW_HEIGHT: 'previewHeight',\n  PREVIEW_URL: 'previewURL',\n  PREVIEW_WIDTH: 'previewWidth',\n  TAGS: 'tags',\n  TYPE: 'type',\n  USER: 'user',\n  USER_IMAGE_URL: 'userImageURL',\n  USER_ID: 'user_id',\n  VIEWS: 'views',\n  WEB_FORMAT_HEIGHT: 'webformatHeight',\n  WEB_FORMAT_URL: 'webformatURL',\n  WEB_FORMAT_WIDTH: 'webformatWidth',\n};\n\nexport const GALLERY_LEGEND_ITEM_LABELS = {\n  LIKES: 'Likes', VIEWS: 'Views', COMMENTS: 'Comments', DOWNLOADS: 'Downloads',\n};\n\nexport const FORM_ELEMENTS = {\n  SEARCH: 'search',\n};\n\nexport const CSS_STYLES = {\n  HIDDEN: 'hidden',\n\n  GALLERY_ITEM: 'gallery-item',\n  GALLERY_LINK: 'gallery-link',\n  GALLERY_IMAGE: 'gallery-image',\n\n  GALLERY_LEGEND: 'gallery-legend',\n  GALLERY_LEGEND_ITEM: 'gallery-legend-item',\n  GALLERY_LEGEND_ITEM_LABEL: 'gallery-legend-item-label',\n  GALLERY_LEGEND_ITEM_VALUE: 'gallery-legend-item-value',\n};\n\n","import 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport { QUERY_PARAMS } from '../constants.js';\n\nlet params = {\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  min_width: '360',\n  max_height: '200',\n  per_page: '200',\n};\n\nfunction createURL(value, page = 1, per_page = 15) {\n  params.page = String(page);\n  params.per_page = String(per_page);\n\n  let searchParams = new URLSearchParams(params);\n  return `${QUERY_PARAMS.URL}?key=${QUERY_PARAMS.API_KEY}&q=${value}&${searchParams}`;\n}\n\nexport async function getData(value, page, per_page) {\n  let response = await axios.get(createURL(value, page, per_page));\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { CSS_STYLES, GALLERY_LEGEND_ITEM_LABELS, HITS_ITEM } from '../constants.js';\n\nconst gallery = document.querySelector('.gallery');\nlet lightbox = null;\n\nlet galleryItems = (items) => {\n  return items.map(item => {\n    return `<li class=${CSS_STYLES.GALLERY_ITEM}>\n        <a class=${CSS_STYLES.GALLERY_LINK} href=\"${item[HITS_ITEM.LARGE_IMAGE_URL]}\">\n          <img\n            class=${CSS_STYLES.GALLERY_IMAGE}\n            src=\"${item[HITS_ITEM.PREVIEW_URL]}\"\n            alt=\"${item[HITS_ITEM.TAGS]}\"\n          />\n          <span class=${CSS_STYLES.GALLERY_LEGEND}>\n                <div class=${CSS_STYLES.GALLERY_LEGEND_ITEM}>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_LABEL}>${GALLERY_LEGEND_ITEM_LABELS.LIKES}</p>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_VALUE}>${item[HITS_ITEM.LIKES]}</p>\n                </div>\n                <div class=${CSS_STYLES.GALLERY_LEGEND_ITEM}>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_LABEL}>${GALLERY_LEGEND_ITEM_LABELS.VIEWS}</p>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_VALUE}>${item[HITS_ITEM.VIEWS]}</p>\n               </div>\n                <div class=${CSS_STYLES.GALLERY_LEGEND_ITEM}>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_LABEL}>${GALLERY_LEGEND_ITEM_LABELS.COMMENTS}</p>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_VALUE}>${item[HITS_ITEM.COMMENTS]}</p>\n               </div>\n                <div class=${CSS_STYLES.GALLERY_LEGEND_ITEM}>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_LABEL}>${GALLERY_LEGEND_ITEM_LABELS.DOWNLOADS}</p>\n                  <p class=${CSS_STYLES.GALLERY_LEGEND_ITEM_VALUE}>${item[HITS_ITEM.DOWNLOADS]}</p>\n               </div>\n            </span>\n          </a>\n        </li>\n      `;\n\n  }).join('');\n};\n\n// noinspection JSValidateTypes\nlightbox = new SimpleLightbox('.gallery a', {\n  captions: true, captionDelay: 250, captionPosition: 'bottom', captionsData: 'alt',\n});\n\n\nexport function fillGalleryWithImages(images) {\n  gallery.insertAdjacentHTML('beforeend', galleryItems(images));\n  refreshLightbox();\n}\n\nexport function refreshLightbox() {\n  lightbox.refresh();\n}","import iziToast from 'izitoast';\nimport * as pixabay from './js/pixabay-api.js';\nimport * as render from './js/render-functions.js';\nimport {\n  CSS_STYLES,\n  EVENT_LISTENER_TYPE,\n  FORM_ELEMENTS,\n  PAGE_ELEMENTS,\n  RESPONSE,\n  SCROLL_BEHAVIOR,\n  TOAST_MESSAGE,\n  TOAST_METHODS,\n  TOAST_POSITIONS,\n} from './constants.js';\n\nconst form = document.querySelector(PAGE_ELEMENTS.FORM);\nconst loader = document.querySelector(PAGE_ELEMENTS.LOADER);\nconst gallery = document.querySelector(PAGE_ELEMENTS.GALLERY);\nconst btnMore = document.querySelector(PAGE_ELEMENTS.BTN_MORE);\nlet page = 1;\nlet per_page = 15;\nlet totalPages = null;\nlet prevQueryValue = null;\nlet totalHits = null;\nlet elementHeight = null;\n\n\nfunction toggleLoader() {\n  if (page > 1) {\n    btnMore.classList.toggle(CSS_STYLES.HIDDEN);\n  }\n  loader.classList.toggle(CSS_STYLES.HIDDEN);\n}\n\nfunction hideBtnMore() {\n  btnMore.classList.add(CSS_STYLES.HIDDEN);\n}\n\nfunction hideLoader() {\n  loader.classList.add(CSS_STYLES.HIDDEN);\n}\n\nfunction showToast({ position = TOAST_POSITIONS.TOP_RIGHT, method = TOAST_METHODS.INFO, message }) {\n  iziToast[method]({\n    position: position, message: message,\n  });\n}\n\nfunction scrollWindow(height) {\n  window.scrollBy(\n    {\n      top: height * 2,\n      left: 0,\n      behavior: SCROLL_BEHAVIOR,\n    },\n  );\n}\n\nfunction endOfSearchResult({ totalPages }) {\n  if (page > totalPages) {\n    showToast({\n      message: TOAST_MESSAGE.REACHED_END_OF_SEARCH_RESULTS,\n    });\n    page = 1;\n    hideBtnMore();\n    hideLoader();\n    return false;\n  }\n}\n\n\nform.addEventListener(EVENT_LISTENER_TYPE.SUBMIT, (e) => {\n  const input = e.target.elements[FORM_ELEMENTS.SEARCH];\n  prevQueryValue = input.value.trim();\n\n  e.preventDefault();\n  gallery.innerHTML = '';\n  toggleLoader();\n  page = 1;\n\n  if (input.value.trim().length === 0) {\n    toggleLoader();\n    showToast({\n      message: TOAST_MESSAGE.VALID_SEARCH_QUERY, method: TOAST_METHODS.WARNING,\n    });\n    return false;\n  }\n\n  pixabay.getData(input.value.trim(), page, per_page)\n    .then(data => {\n      if (data[RESPONSE.HITS].length < 1) {\n        showToast({\n          method: TOAST_METHODS.WARNING, message: TOAST_MESSAGE.NO_IMAGES_MATCHING_SEARCH_QUERY,\n        });\n        hideBtnMore();\n        hideLoader();\n        return false;\n      }\n      totalHits = data[RESPONSE.TOTAL_HITS];\n      render.fillGalleryWithImages(data[RESPONSE.HITS]);\n      page++;\n    })\n    .catch(error => {\n      showToast({\n        method: TOAST_METHODS.ERROR, message: TOAST_MESSAGE.QUERY_FAILED,\n      });\n      throw new Error(error.message);\n    })\n    .finally(() => {\n\n      elementHeight = document.querySelector(PAGE_ELEMENTS.GALLERY_ITEM).getBoundingClientRect().height;\n      toggleLoader();\n      totalPages = Math.ceil(totalHits / per_page);\n      endOfSearchResult({ page, totalPages });\n    });\n\n  form.reset();\n});\n\n\nbtnMore.addEventListener(EVENT_LISTENER_TYPE.CLICK, (e) => {\n  e.preventDefault();\n  toggleLoader();\n  totalPages = Math.ceil(totalHits / per_page);\n\n  pixabay.getData(prevQueryValue, page, per_page)\n    .then(data => {\n      render.fillGalleryWithImages(data[RESPONSE.HITS]);\n      page++;\n\n      scrollWindow(elementHeight);\n    })\n    .catch(error => {\n      showToast({\n        method: TOAST_METHODS.ERROR, message: TOAST_MESSAGE.QUERY_FAILED,\n      });\n      throw new Error(error.message);\n    })\n    .finally(() => {\n      toggleLoader();\n      endOfSearchResult({ page, totalPages });\n    });\n});\n\n\n\n"],"names":["TOAST_POSITIONS","TOAST_MESSAGE","TOAST_METHODS","EVENT_LISTENER_TYPE","PAGE_ELEMENTS","QUERY_PARAMS","SCROLL_BEHAVIOR","RESPONSE","HITS_ITEM","GALLERY_LEGEND_ITEM_LABELS","FORM_ELEMENTS","CSS_STYLES","params","createURL","value","page","per_page","searchParams","getData","axios","gallery","lightbox","galleryItems","items","item","SimpleLightbox","fillGalleryWithImages","images","refreshLightbox","form","loader","btnMore","totalPages","prevQueryValue","totalHits","elementHeight","toggleLoader","hideBtnMore","hideLoader","showToast","position","method","message","iziToast","scrollWindow","height","endOfSearchResult","e","input","pixabay.getData","data","render.fillGalleryWithImages","error"],"mappings":"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"}